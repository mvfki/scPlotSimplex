<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Create ternary plots that show similarity between single cells and
selected three terminals in a ternary baricentric coordinate."><title>Create ternary plots — plotTernary • CytoSimplex</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create ternary plots — plotTernary"><meta property="og:description" content="Create ternary plots that show similarity between single cells and
selected three terminals in a ternary baricentric coordinate."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">CytoSimplex</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/CytoSimplex.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/welch-lab/CytoSimplex">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create ternary plots</h1>
      <small class="dont-index">Source: <a href="https://github.com/welch-lab/CytoSimplex/blob/HEAD/R/ternary.R" class="external-link"><code>R/ternary.R</code></a></small>
      <div class="d-none name"><code>plotTernary.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create ternary plots that show similarity between single cells and
selected three terminals in a ternary baricentric coordinate.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotTernary</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">plotTernary</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">clusterVar</span>,</span>
<span>  <span class="va">vertices</span>,</span>
<span>  features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  veloGraph <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  byCluster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  processed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"euclidean"</span>, <span class="st">"cosine"</span>, <span class="st">"pearson"</span>, <span class="st">"spearman"</span><span class="op">)</span>,</span>
<span>  force <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fl">0.08</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dotColor <span class="op">=</span> <span class="st">"grey60"</span>,</span>
<span>  returnData <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for Seurat</span></span>
<span><span class="fu">plotTernary</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">"counts"</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clusterVar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  processed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for SingleCellExperiment</span></span>
<span><span class="fu">plotTernary</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  assay.type <span class="op">=</span> <span class="st">"counts"</span>,</span>
<span>  clusterVar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  processed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for simMat</span></span>
<span><span class="fu">plotTernary</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  veloMat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nGrid <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  radius <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  dotSize <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  dotColor <span class="op">=</span> <span class="st">"grey60"</span>,</span>
<span>  labelColors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#3B4992FF"</span>, <span class="st">"#EE0000FF"</span>, <span class="st">"#008B45FF"</span><span class="op">)</span>,</span>
<span>  vertexLabelSize <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  vertexLabelDrift <span class="op">=</span> <span class="fl">0.03</span>,</span>
<span>  axisBreak <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  axisTextShow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  axisTextSize <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  axisTextDrift <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>  gridLineAlpha <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  arrowLinewidth <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  arrowAngle <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  arrowLen <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  titleSize <span class="op">=</span> <span class="fl">14</span>,</span>
<span>  equilateral <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  margin <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>Input data. Can be a <code>matrix</code> or <code>dgCMatrix</code> object with
cells as columns, a <code>Seurat</code> or <code>SingleCellExperiment</code> object.
"simMat" method takes intermediate values.</p></dd>


<dt>...</dt>
<dd><p>Arguments passed to other methods.</p></dd>


<dt>clusterVar</dt>
<dd><p>A vector/factor assigning the cluster variable to each
column of the matrix object. For "Seurat" method, <code>NULL</code> (default) for
<code>Idents(x)</code>, or a variable name in <code>meta.data</code> slot. For
"SingleCellExperiment" method, <code>NULL</code> (default) for <code>colLabels(x)</code>,
or a variable name in <code>colData</code> slot.</p></dd>


<dt>vertices</dt>
<dd><p>Vector of three unique cluster names that will be used for
plotting. Or a named list that groups clusters as three terminal vertices.
There must not be any overlap between groups.</p></dd>


<dt>features</dt>
<dd><p>Valid matrix row subsetting index to select features for
similarity calculation. Default <code>NULL</code> uses all available features.</p></dd>


<dt>veloGraph</dt>
<dd><p>Cell x cell <code>dgCMatrix</code> object containing velocity
information. Shows velocity grid-arrow layer when specified. Default
<code>NULL</code> does not show velocity.</p></dd>


<dt>byCluster</dt>
<dd><p>Default <code>NULL</code> to generate one plot with all cells.
Set <code>"all"</code> to split cells in plot by cluster and returns a list of
subplots for each cluster as well as the plot including all cells. Otherwise,
a vector of cluster names to generate a list of subplots for the specified
clusters.</p></dd>


<dt>processed</dt>
<dd><p>Logical. Whether the input matrix is already processed.
<code>TRUE</code> will bypass internal preprocessing and input matrix will be
directly used for similarity calculation. Default <code>FALSE</code> and raw count
input is recommended. If missing in call, using <code>slot = "counts"</code> in
"Seurat" method or using <code>assay.type = "counts"</code> in
"SingleCellExperiment" method will force this argument to be <code>FALSE</code> and
others for <code>TRUE</code>.</p></dd>


<dt>method</dt>
<dd><p>Similarity calculation method. Default <code>"euclidean"</code>.
Choose from <code>"euclidean"</code>, <code>"cosine"</code>, <code>"pearson"</code>,
<code>"spearman"</code>.</p></dd>


<dt>force</dt>
<dd><p>Whether to force calculate the similarity when more then 500
features are detected, which is generally not recommended. Default
<code>FALSE</code>.</p></dd>


<dt>sigma</dt>
<dd><p>Gaussian kernel parameter that controls the effect of variance.
Only effective when using a distance metric (i.e. <code>method</code> is
<code>"euclidian"</code> or <code>"cosine"</code>). Larger values tighten the dot
spreading on figure. Default <code>0.08</code>.</p></dd>


<dt>scale</dt>
<dd><p>Whether to min-max scale the distance matrix by clusters.
Default <code>TRUE</code>.</p></dd>


<dt>returnData</dt>
<dd><p>Logical. Whether to return similarity and aggregated
velocity data if applicable instead of generating plot. Default <code>FALSE</code>.</p></dd>


<dt>layer</dt>
<dd><p>For "Seurat" method, which layer of the assay to be used.
Default <code>"counts"</code>.</p></dd>


<dt>assay</dt>
<dd><p>For "Seurat" method, the specific assay to get data from.
Default <code>NULL</code> to the default assay.</p></dd>


<dt>assay.type</dt>
<dd><p>For "SingleCellExperiment" methods. Which assay to use for
calculating the similarity. Default <code>"counts"</code>.</p></dd>


<dt>title</dt>
<dd><p>Title text of the plot. Default <code>NULL</code>.</p></dd>


<dt>veloMat</dt>
<dd><p>Aggregated velocity matrix. Output of <code>aggrVeloGraph</code>.</p></dd>


<dt>nGrid</dt>
<dd><p>Number of grids along the bottom side of the equilateral
triangle. Default <code>10</code>.</p></dd>


<dt>radius</dt>
<dd><p>Arrow length of unit velocity. Lower this when arrows point
outside of the coordinate. Default <code>0.1</code>.</p></dd>


<dt>dotSize, dotColor</dt>
<dd><p>Dot aesthetics passed to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></code>. Default <code>0.6</code> and <code>"grey60"</code>.</p></dd>


<dt>labelColors</dt>
<dd><p>Colors of the axis lines and vertex labels.
Default <code>c("#3B4992FF", "#EE0000FF", "#008B45FF")</code> (blue, red and green)</p></dd>


<dt>vertexLabelSize, vertexLabelDrift</dt>
<dd><p>Adjustment on the three vertex text
labels. Drift means the distance that the labels should be moved against the
center of the plot. Default size <code>5</code>, drifted distance <code>0.03</code>.</p></dd>


<dt>axisBreak</dt>
<dd><p>Number of breaks to be labeled along axis. Default
<code>5</code>.</p></dd>


<dt>axisTextShow</dt>
<dd><p>Logical, whether to show axis text. Default <code>TRUE</code>.</p></dd>


<dt>axisTextSize, axisTextDrift</dt>
<dd><p>Similar to the vertex adjustment applied
to the text label along the axis breaks. Default size <code>4</code>, drifted
distance <code>0.02</code>.</p></dd>


<dt>gridLineAlpha</dt>
<dd><p>Transparency of background grid lines. Default
<code>0.6</code>.</p></dd>


<dt>arrowLinewidth, arrowAngle, arrowLen</dt>
<dd><p>Arrow aesthetics, see Details.</p></dd>


<dt>titleSize</dt>
<dd><p>Size of title text. Default <code>14</code>.</p></dd>


<dt>equilateral</dt>
<dd><p>Logical, whether to always display the triangle as
equilateral. Default <code>TRUE</code>.</p></dd>


<dt>margin</dt>
<dd><p>Margin allowed around of the triangle plotting region when
<code>equilateral = TRUE</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>For "simMat" method, a ggplot object. For other methods, a ggplot
object when <code>splitCluster = FALSE</code>, or a list of ggplot objects when
<code>splitCluster = TRUE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><b>Argument inheritance</b> - For matrix/dgCMatrix ("default" method), we
first calculate the similarity matrix and obtain a "simMat" object. Then the
"simMat" method is internally called. For data container objects (e.g.
Seurat), we obtain the correct data matrix first and then call the "default"
method. The arguments inherits as the flow described above.</p>
<p><b>The calculation of similarity matrix</b> - The similarity is calculated
either by converting a distance metric ("euclidean" or "cosine") with
Gaussian kernel, or directly computed with correlation metrics ("pearson" or
"spearman"). The centroid of each terminal is obtained first, and the
specified metric from each cell to each terminal is calculated. The
similarity matrix (n cells by v terminals) is lastly normalized to sum to 1
for each cell, so it becomes a baricentric coordinate.</p>
<p><b>Arrow aesthetics parameters</b> - The shape of arrows is controlled by 3
arguments. Considering an arrow as the combination of a line segment and a
triangle, <code>arrowLinewidth</code> controls the width of the line as well as
the edge line of the triangle; <code>arrowAngle</code> equals to angle of the
arrow-tip vertex of the triangle devided by 2 (e.g. the triangle is
equilateral when <code>arrowAngle = 20</code>); <code>arrowLen</code> controls the
absolute length from the arrow-tip vertex to its opposite edge.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="selectTopFeatures.html">selectTopFeatures</a></span><span class="op">(</span><span class="va">rnaRaw</span>, <span class="va">rnaCluster</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OS"</span>, <span class="st">"RE"</span>, <span class="st">"CH"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selected 30 features for "CH".</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selected 30 features for "OS".</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selected 30 features for "RE".</span>
<span class="r-in"><span><span class="fu">plotTernary</span><span class="op">(</span><span class="va">rnaRaw</span>, <span class="va">rnaCluster</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OS"</span>, <span class="st">"RE"</span>, <span class="st">"CH"</span><span class="op">)</span>, <span class="va">gene</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotTernary-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Seurat example</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">srt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/CreateSeuratObject.html" class="external-link">CreateSeuratObject</a></span><span class="op">(</span><span class="va">rnaRaw</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Feature names cannot have underscores ('_'), replacing with dashes ('-')</span>
<span class="r-in"><span><span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/Idents.html" class="external-link">Idents</a></span><span class="op">(</span><span class="va">srt</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">rnaCluster</span></span></span>
<span class="r-in"><span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="selectTopFeatures.html">selectTopFeatures</a></span><span class="op">(</span><span class="va">srt</span>, vertices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OS"</span>, <span class="st">"RE"</span>, <span class="st">"CH"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selected 30 features for "CH".</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selected 30 features for "OS".</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selected 30 features for "RE".</span>
<span class="r-in"><span><span class="fu">plotTernary</span><span class="op">(</span><span class="va">srt</span>, features <span class="op">=</span> <span class="va">gene</span>, vertices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OS"</span>, <span class="st">"RE"</span>, <span class="st">"CH"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotTernary-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># SingleCellExperiment example</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SingleCellExperiment</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a></span><span class="op">(</span>assays <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>counts <span class="op">=</span> <span class="va">rnaRaw</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/colLabels.html" class="external-link">colLabels</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">rnaCluster</span></span></span>
<span class="r-in"><span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="selectTopFeatures.html">selectTopFeatures</a></span><span class="op">(</span><span class="va">sce</span>, vertices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OS"</span>, <span class="st">"RE"</span>, <span class="st">"CH"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selected 30 features for "CH".</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selected 30 features for "OS".</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selected 30 features for "RE".</span>
<span class="r-in"><span><span class="fu">plotTernary</span><span class="op">(</span><span class="va">sce</span>, features <span class="op">=</span> <span class="va">gene</span>, vertices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OS"</span>, <span class="st">"RE"</span>, <span class="st">"CH"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotTernary-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yichen Wang, Jialin Liu.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

