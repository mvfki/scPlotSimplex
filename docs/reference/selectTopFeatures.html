<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Performs wilcoxon rank-sum test on input matrix. While clusterVar and
vertices together defines the groups of cells to be set as terminals
of the simplex, this function will test each of these groups against the rest
of the cells. The U-Statistics (statistic), p-value (pval) and
adjusted p-value (padj), together with average presence in group
(avgExpr), log fold-change (logFC), AUC (auc),
percentage in group (pct_in) and percentage out of group
(pct_out) will be calculated. Set returnStats = TRUE to return
the full statistics table.
Top features are selected by sorting primarily on adjusted p-value, and
secondarily on log fold-change, after filtering for up-regulated features."><title>Pick top differentially presented features for similarity calculation — selectTopFeatures • CytoSimplex</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Pick top differentially presented features for similarity calculation — selectTopFeatures"><meta property="og:description" content="Performs wilcoxon rank-sum test on input matrix. While clusterVar and
vertices together defines the groups of cells to be set as terminals
of the simplex, this function will test each of these groups against the rest
of the cells. The U-Statistics (statistic), p-value (pval) and
adjusted p-value (padj), together with average presence in group
(avgExpr), log fold-change (logFC), AUC (auc),
percentage in group (pct_in) and percentage out of group
(pct_out) will be calculated. Set returnStats = TRUE to return
the full statistics table.
Top features are selected by sorting primarily on adjusted p-value, and
secondarily on log fold-change, after filtering for up-regulated features."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">CytoSimplex</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/CytoSimplex.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/welch-lab/CytoSimplex">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Pick top differentially presented features for similarity calculation</h1>
      <small class="dont-index">Source: <a href="https://github.com/welch-lab/CytoSimplex/blob/HEAD/R/selectTopFeatures.R" class="external-link"><code>R/selectTopFeatures.R</code></a></small>
      <div class="d-none name"><code>selectTopFeatures.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs wilcoxon rank-sum test on input matrix. While <code>clusterVar</code> and
<code>vertices</code> together defines the groups of cells to be set as terminals
of the simplex, this function will test each of these groups against the rest
of the cells. The U-Statistics (<code>statistic</code>), p-value (<code>pval</code>) and
adjusted p-value (<code>padj</code>), together with average presence in group
(<code>avgExpr</code>), log fold-change (<code>logFC</code>), AUC (<code>auc</code>),
percentage in group (<code>pct_in</code>) and percentage out of group
(<code>pct_out</code>) will be calculated. Set <code>returnStats = TRUE</code> to return
the full statistics table.</p>
<p>Top features are selected by sorting primarily on adjusted p-value, and
secondarily on log fold-change, after filtering for up-regulated features.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">selectTopFeatures</span><span class="op">(</span><span class="va">x</span>, <span class="va">clusterVar</span>, <span class="va">vertices</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">selectTopFeatures</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">clusterVar</span>,</span>
<span>  <span class="va">vertices</span>,</span>
<span>  nTop <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  processed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  lfcThresh <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  returnStats <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for Seurat</span></span>
<span><span class="fu">selectTopFeatures</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  clusterVar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">vertices</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  layer <span class="op">=</span> <span class="st">"counts"</span>,</span>
<span>  processed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for SingleCellExperiment</span></span>
<span><span class="fu">selectTopFeatures</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  clusterVar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">vertices</span>,</span>
<span>  assay.type <span class="op">=</span> <span class="st">"counts"</span>,</span>
<span>  processed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>Dense or sparse matrix, observation per column. Preferrably a raw
count matrix. Alternatively, a <code>Seurat</code> object or a
<code>SingleCellExperiment</code> object.</p></dd>


<dt>clusterVar</dt>
<dd><p>A vector/factor assigning the cluster variable to each
column of the matrix object. For "Seurat" method, <code>NULL</code> (default) for
<code>Idents(x)</code>, or a variable name in <code>meta.data</code> slot. For
"SingleCellExperiment" method, <code>NULL</code> (default) for <code>colLabels(x)</code>,
or a variable name in <code>colData</code> slot.</p></dd>


<dt>vertices</dt>
<dd><p>Vector of cluster names that will be used for plotting. Or a
named list that groups clusters as a terminal vertex. There must not be any
overlap between groups.</p></dd>


<dt>...</dt>
<dd><p>Arguments passed to methods.</p></dd>


<dt>nTop</dt>
<dd><p>Number of top differentially presented features per terminal.
Default <code>30</code>.</p></dd>


<dt>processed</dt>
<dd><p>Logical. Whether the input matrix is already processed.
<code>TRUE</code> will bypass internal preprocessing and input matrix will be
directly used for rank-sum calculation. Default <code>FALSE</code> and raw count
input is recommended.</p></dd>


<dt>lfcThresh</dt>
<dd><p>Threshold on log fold-change to identify up-regulated
features. Default <code>0.1</code>.</p></dd>


<dt>returnStats</dt>
<dd><p>Logical. Whether to return the full statistics table
rather then returning the selected genes. Default <code>FALSE</code></p></dd>


<dt>assay</dt>
<dd><p>Assay name of the Seurat object to be used. Default <code>NULL</code>.</p></dd>


<dt>layer</dt>
<dd><p>For "Seurat" method, which layer of the assay to be used.
Default <code>"counts"</code>.</p></dd>


<dt>assay.type</dt>
<dd><p>Assay name of the SingleCellExperiment object to be used.
Default <code>"counts"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>When <code>returnStats = FALSE</code> (default), a character vector of at
most <code>length(unique(vertices))*nTop</code> feature names. When
<code>returnStats = TRUE</code>, a data.frame of wilcoxon rank sum test statistics.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">selectTopFeatures</span><span class="op">(</span><span class="va">rnaRaw</span>, <span class="va">rnaCluster</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OS"</span>, <span class="st">"RE"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selected 30 features for "OS".</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selected 30 features for "RE".</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "Insc"          "Pacsin1"       "Pcdh7"         "Lipc"         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] "Col1a2"        "Col1a1"        "Col22a1"       "Cpz"          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "Slc36a2"       "Cdo1"          "Kcnk1"         "Ano1"         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "Mlip"          "Col13a1"       "Robo2"         "Cadm1"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] "Ifitm5"        "Tmem119"       "Serpinf1"      "Sema3b"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21] "Col24a1"       "Shc2"          "Kazald1"       "Entpd3"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] "RP23-457J22.1" "Enpp6"         "Creb3l3"       "Wisp1"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29] "Elmo1"         "Mmp16"         "Agt"           "Rarres2"      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33] "Kng1"          "Mgst1"         "Cxcl14"        "Plpp3"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37] "Adipoq"        "Kitl"          "Gpm6b"         "Wisp2"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [41] "Vcam1"         "Serping1"      "Lpl"           "Vegfc"        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [45] "Col4a2"        "Col4a1"        "Kng2"          "Fbn1"         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [49] "Pdgfrb"        "Grem1"         "Cxcl12"        "Cyp1b1"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [53] "Dpep1"         "Fbln5"         "Lepr"          "Igfbp5"       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [57] "Hp"            "Fstl1"         "Esm1"          "Tgfbr3"       </span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Seurat example</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">srt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/CreateSeuratObject.html" class="external-link">CreateSeuratObject</a></span><span class="op">(</span><span class="va">rnaRaw</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Feature names cannot have underscores ('_'), replacing with dashes ('-')</span>
<span class="r-in"><span><span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/Idents.html" class="external-link">Idents</a></span><span class="op">(</span><span class="va">srt</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">rnaCluster</span></span></span>
<span class="r-in"><span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="fu">selectTopFeatures</span><span class="op">(</span><span class="va">srt</span>, vertices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OS"</span>, <span class="st">"RE"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selected 30 features for "OS".</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selected 30 features for "RE".</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># SingleCellExperiment example</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SingleCellExperiment</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a></span><span class="op">(</span>assays <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>counts <span class="op">=</span> <span class="va">rnaRaw</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/colLabels.html" class="external-link">colLabels</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">rnaCluster</span></span></span>
<span class="r-in"><span><span class="va">gene</span> <span class="op">&lt;-</span> <span class="fu">selectTopFeatures</span><span class="op">(</span><span class="va">sce</span>, vertices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"OS"</span>, <span class="st">"RE"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selected 30 features for "OS".</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selected 30 features for "RE".</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yichen Wang, Jialin Liu.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

